# VSCode JSON转换插件使用说明

## 插件功能概述

这个VSCode插件提供了强大的JSON检测和转换功能，当用户选择代码片段时，插件会自动检测是否为JSON格式，并提供相应的转换选项。

## 安装和激活

1. 在VSCode中打开扩展开发主机（Extension Development Host）
2. 插件会自动激活，在控制台可以看到激活信息
3. 插件提供了两个主要命令和多种触发方式

## 触发方式

### 1. 快捷键触发
- **Windows/Linux**: `Ctrl+Shift+J`
- **Mac**: `Cmd+Shift+J`

### 2. 右键菜单触发
- 选中文本后右键
- 选择 "转换JSON格式"

### 3. 命令面板触发
- 按 `Ctrl+Shift+P` (Windows/Linux) 或 `Cmd+Shift+P` (Mac)
- 输入 "检查选中文本是否为JSON" 或 "转换JSON格式"

## 功能详解

### 检查JSON格式 (`jsonstr.checkSelectedText`)

**触发条件**: 选中文本后按快捷键或通过命令面板

**功能**:
1. 检测选中的文本是否为有效的JSON格式
2. 如果是有效JSON，提供转换选项：
   - 转换为格式化JSON
   - 转换为压缩JSON
   - 转换为字符串
3. 如果不是有效JSON，显示错误提示

**示例**:
```json
// 选中这个压缩的JSON
{"name":"张三","age":25,"hobbies":["编程","阅读"]}

// 按快捷键后，选择"转换为格式化JSON"
// 结果：
{
  "name": "张三",
  "age": 25,
  "hobbies": [
    "编程",
    "阅读"
  ]
}
```

### 转换JSON格式 (`jsonstr.convertJson`)

**触发条件**: 右键菜单

**功能**:
1. 智能检测选中文本的类型
2. 根据类型提供相应的转换选项：

#### 如果是JSON字符串
- **解析为对象**: 将JSON字符串解析为格式化的对象
- **格式化JSON**: 保持字符串格式但进行格式化

#### 如果是JSON对象
- **转换为字符串**: 将JSON对象转换为字符串
- **压缩JSON**: 将格式化的JSON压缩

**示例**:
```json
// 选中JSON字符串
"{\"name\":\"李四\",\"age\":30}"

// 右键选择"转换JSON格式"，然后选择"解析为对象"
// 结果：
{
  "name": "李四",
  "age": 30
}
```

## 支持的JSON类型

插件支持所有标准的JSON数据类型：

### 1. JSON对象
```json
{"name":"张三","age":25}
```

### 2. JSON数组
```json
[1, 2, 3, "hello", {"key": "value"}]
```

### 3. JSON字符串
```json
"hello world"
```

### 4. JSON数字
```json
42
```

### 5. JSON布尔值
```json
true
false
```

### 6. JSON null
```json
null
```

## 错误处理

插件包含完善的错误处理机制：

### 1. 输入验证
- 检查是否有选中的文本
- 验证文本是否为字符串类型

### 2. JSON格式验证
- 检测语法错误
- 识别无效的JSON格式
- 提供友好的中文错误提示

### 3. 转换安全
- 安全的JSON解析
- 防止数据丢失
- 异常处理和恢复

## 使用场景

### 1. 开发调试
- 快速格式化API响应数据
- 压缩JSON以减少传输大小
- 验证JSON格式的正确性

### 2. 数据处理
- 在JSON字符串和对象之间转换
- 格式化配置文件
- 清理和标准化JSON数据

### 3. 文档编写
- 格式化示例JSON
- 生成测试数据
- 创建API文档

## 最佳实践

### 1. 选择合适的触发方式
- 快速检查：使用快捷键
- 详细转换：使用右键菜单
- 批量操作：使用命令面板

### 2. 注意数据安全
- 转换前备份重要数据
- 验证转换结果的正确性
- 注意JSON中的特殊字符

### 3. 提高效率
- 熟悉快捷键操作
- 了解不同转换选项的用途
- 利用错误提示快速定位问题

## 故障排除

### 1. 插件未激活
- 检查VSCode版本是否支持
- 查看控制台错误信息
- 重新加载窗口

### 2. 命令不响应
- 确认有选中的文本
- 检查快捷键是否被占用
- 尝试使用命令面板

### 3. 转换失败
- 检查JSON格式是否正确
- 查看错误提示信息
- 尝试手动验证JSON

## 技术细节

### 插件架构
- 基于VSCode Extension API
- 使用TypeScript确保类型安全
- 模块化设计，易于维护

### JSON处理
- 使用原生JSON.parse/stringify
- 自定义错误处理逻辑
- 支持各种JSON格式

### 用户交互
- 异步操作处理
- 友好的用户提示
- 安全的文本替换

## 更新日志

### v1.0.0
- 初始版本发布
- 支持JSON检测和转换
- 提供快捷键和右键菜单
- 完善的错误处理机制 